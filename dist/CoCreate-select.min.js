!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CoCreate=t():(e.CoCreate=e.CoCreate||{},e.CoCreate.select=t())}(this,(function(){return(()=>{var e={375:function(e,t,n){var o,i;"undefined"!=typeof self&&self,o=[n(446),n(965)],void 0===(i=function(e,t){return function(e,t,n){return{socket:null,setSocket:function(e){this.socket=e},readDocumentList(e){if(!e)return;let n=t.getCommonParams();e.collection&&e.operator&&(n={...n,...e},this.socket.send("readDocumentList",n))},createDocument:function(n){if(null===n)return;let o=t.getCommonParamsExtend(n),i={...n,...o},c=n.data||{};c.organization_id||(c.organization_id=e.config.organization_Id),n.data&&(c={...c,...n.data}),i.data=c;const r=t.generateSocketClient(n.namespace,n.room);this.socket.send("createDocument",i,r)},updateDocument:function(e){if(!e||!n.checkDocumentId(e.document_id))return;let o=t.getCommonParamsExtend(e),i={...e,...o};if("object"==typeof e.data&&(i.set=e.data),Array.isArray(e.delete_fields)&&(i.unset=e.delete_fields),!i.set&&!i.unset)return;!1===e.broadcast&&(i.broadcast=!1),void 0===e.broadcast_sender&&(i.broadcast_sender=!0);const c=t.generateSocketClient(e.namespace,e.room);this.socket.send("updateDocument",i,c)},readDocument:function(e){if(null===e)return;if(!e||!n.checkDocumentId(e.document_id))return;let o=t.getCommonParamsExtend(e),i={...e,...o};this.socket.send("readDocument",i)},deleteDocument:function(e){if(!e||!n.checkDocumentId(e.document_id))return;let o=t.getCommonParamsExtend(e),i={...e,...o};const c=t.generateSocketClient(e.namespace,e.room);this.socket.send("deleteDocument",i,c)},exportCollection:function(e){if(null===e)return;let n=t.getCommonParamsExtend(e);n.collection=e.collection,n.export_type=e.export_type,n.metadata=e.metadata,this.socket.send("exportDB",n)},importCollection:function(n){const{file:o}=n;if(null===n||!(o instanceof e.File))return;const i=o.name.split(".").pop();if(!["json","csv"].some((e=>e===i)))return;let c=t.getCommonParamsExtend(n);c.collection=n.collection,c.import_type=i,this.socket.send("importDB",c),this.socket.sendFile(o)},listen:function(e,t){this.socket.listen(e,t)},listenAsync:function(e){return this.socket.listenAsync(e)},createSocket:function(e,t){t?(this.socket.create({namespace:t,room:null,host:e}),this.socket.setGlobalScope(t)):this.socket.create({namespace:null,room:null,host:e})},...n}}(window,e,t)}.apply(t,o))||(e.exports=i)},611:function(e,t,n){var o,i;"undefined"!=typeof self&&self,o=[n(585),n(375)],void 0===(i=function(e,t){return function(e,t,n){if(e){let e=new t("ws");n.setSocket(e),n.createSocket(window.config.host?window.config.host:window.location.hostname,window.config.organization_Id)}return n}(!0,e,t)}.apply(t,o))||(e.exports=i)},965:function(e,t){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(){function e(t,n){t=t||{};for(let o of Object.keys(n))n[o]instanceof Object&&Object.assign(n[o],e(t[o],n[o]));return Object.assign(t||{},n),t}function t(e,t){if(!t)return e;let n=t.split("."),o=e;for(var i=n.length-1;i>=0;i--)o={[n[i]]:o};return o}function n(e,t){try{let n=/([\w\W]+)\[(\d+)\]/gm.exec(e);if(n&&3==n.length){let o=n[1],i=parseInt(n[2]);t[o]&&Array.isArray(t[o])||(t[o]=[]),t[o][i]=t[e],delete t[e],e=o}}catch{}return e}function o(e){return!!e&&e.constructor===Object}function i(e){return!!e&&e.constructor===Array}function c(o){let i=Object.keys(o),c={};return i.forEach((i=>{if((i=n(i,o)).split(".").length>1){let n=t(o[i],i);delete o[i],c=e(c,n)}else c[i]=o[i]})),c}function r(e){let t=Object.keys(e),n={};return t.forEach((t=>{let c=e[t];if(o(e[t])){let o=r(e[t]);Object.keys(o).forEach((e=>{let i=o[e];n[e=t+"."+e]=i}))}else i(c)?c.forEach(((e,o)=>{n[`${t}[${o}]`]=e})):n[t]=e[t]})),n}function a(e){if(e)return{collection:e.getAttribute("data-collection"),document_id:e.getAttribute("data-document_id"),name:e.getAttribute("name")}}function s(e){return e?{is_realtime:m(e),is_save:u(e),is_read:l(e),is_update:d(e)}:{}}const l=e=>f(e,"data-read_value"),u=e=>f(e,"data-save_value"),d=e=>f(e,"data-update_value"),m=e=>!!e&&"false"!=e.getAttribute("data-realtime");function f(e,t){return!!e&&"false"!==e.getAttribute(t)}function h(e){return!!e&&!/{{\s*([\w\W]+)\s*}}/g.test(e)}function p(e){try{let t=JSON.parse(e);return"object"==typeof t&&null!=t}catch(e){return!1}}function g(e){const{collection:t,document_id:n,name:o}=a(e);return!(p(t)||p(o)||!("INPUT"===e.tagName&&["text","email","tel","url"].includes(e.type)||"TEXTAREA"===e.tagName)||!o||!m(e)||"true"===e.getAttribute("data-unique")||"password"===e.type||!l(e))}function _(e){try{return!!e&&"null"!==e.toLowerCase()}catch(e){return!1}}return{decodeObject:c,encodeObject:r,getAttr:a,getFlagAttr:s,isRealtimeAttr:m,isReadAttr:l,isSaveAttr:u,isUpdateAttr:d,checkValue:h,isCRDT:g,checkDocumentId:_}}()}.apply(t,[]))||(e.exports=n)},266:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>_});var o=n(366);function i(e){let t=[{document,window}];for(let e of document.querySelectorAll("iframe")){let n=e.contentDocument||e.contentWindow.document,o=e.contentWindow;t.push({document:n,window:o,frameElement:e})}let n=new Set;for(let o of t){let t=e(o);t&&"function"==typeof t[Symbol.iterator]?t.forEach((e=>n.add(e))):t&&n.add(t)}return Array.from(n)}function c(e){let t=[];do{if(!e||!e.tagName)return!1;let n=e.tagName.toLowerCase();if(e.id&&"BODY"!==e.tagName&&(n+="#"+e.id),e.classList.length&&"BODY"!==e.tagName&&e.classList.forEach((e=>{-1===e.indexOf(":")&&(n+="."+e)})),"BODY"!==e.tagName&&e.parentNode){let t=Array.prototype.indexOf.call(e.parentNode.children,e);n+=`:nth-child(${t+1})`}t.unshift(n),e=e.parentNode}while("HTML"!==e.tagName);return t.join(" > ")}function r(){let e=window;for(;e!==window.parent;)e=window.parent;return e}function a(e,t){let n;return i((e=>{e.document.contains(t)&&(n=e.frameElement)})),n}function*s(e,t){for(let n of e)n.selector&&t.matches(n.selector)&&(yield n)}function l(e){try{document.createDocumentFragment().querySelector(e)}catch(e){return!1}return!0}const u={getElementPath:function(e,t){let n=[],o=(window,a(0,e)),i=c(o);return i&&n.unshift(i),t?{path:n,document:o||document}:n},isValidSelector:l,joinBydelimiter:function(e,t){return e.map((e=>e.trim())).join(t)},splitBydelimiter:function(e,t){return e.split(t).map((e=>e.trim()))},parseTextToHtml:function(e){let t=(new DOMParser).parseFromString(e,"text/html");return t.head.children[0]?t.head.children[0]:t.body.children[0]},UUID:function(e=10){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",o=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*o));return t+=(new Date).toTimeString().replace(/[\W_]+/g,"").substr(0,6)},configExecuter:function(e,t,n,o){for(let i of s(o||window.elementConfig,e)){if(!0===i[t])return n(e,i);if(!1===i[t])return!1;if(void 0===i[t])continue;if(l(i[t]))return n(e,i,!0)}return!1},configMatch:s,getIframeFromPath:function(e){let t=r;return e.forEach((e=>{t&&(t=t.querySelector(e))})),t},findIframeFromElement:a,getTopMostWindow:r,cssPath:c,allFrame:i,checkValue:function(e){return!!e&&!/{{\s*([\w\W]+)\s*}}/g.test(e)},getAttributes:function(e){return e.getAttributeNames().reduce(((t,n)=>(t[n]=e.getAttribute(n),t)),{})},isJsonString:function(e){try{let t=JSON.parse(e);return"object"==typeof t&&null!=t}catch(e){return!1}},getParentFromElement:function(e,t,n){if(t){if(e.classList.contains(t))return e;let n=e.parentNode;for(;null!=n&&n.classList;){if(n.classList.contains(t))return n;n=n.parentNode}}else if(n){if(n.every((t=>e.attributes.hasOwnProperty(t))))return e;let t=e.parentNode;for(;null!=t&&t.attributes;){if(n.every((e=>t.attributes.hasOwnProperty(e))))return t;t=t.parentNode}}return!1},generateUUID:function(e=36){let t=(new Date).getTime(),n=window.performance&&window.performance.now&&1e3*window.performance.now()||0,o="uxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(e<=o.length)o=o.substr(0,e);else{let t=e-o.length,n="-xxxyyxxx",i=Math.floor(t/n.length);for(let e=0;e<i;e++)o+=n;i=t-i*n.length,o+=n.substr(0,i)}return o.replace(/[xy]/g,(function(e){var o=16*Math.random();if(t>0){o=(t+o)%16|0;t=Math.floor(t/16)}else{o=(n+o)%16|0;n=Math.floor(n/16)}return("x"==e?o:7&o|8).toString(16)}))}};var d=n(611),m=n.n(d);const f={attribute:"data-actions",actions:{},selectedStage:[],stageIndex:0,selectedElement:null,completedEventName:"completedEvent",__init:function(){this.actionButtonEvent()},actionButtonEvent:function(){const e=this;document.addEventListener("click",(function(t){let n=t.target;if(n.getAttribute("data-actions")||(n=t.target.closest("[data-actions]")),!n)return;t.preventDefault();let o=(n.getAttribute(e.attribute)||"").replace(/\s/g,"").split(",");0!=o.length&&(e.stageIndex=0,e.selectedStage=o,e.selectedElement=n,e.__runActionFunc())}))},init:function({action:e,callback:t,endEvent:n}){this.registerEvent(e,t,null,n)},registerEvent:function(e,t,n,o){if(this.actions[e])return;this.actions[e]={key:e,runFunc:t,instance:n||window,endEvent:o};for(let t in this.actions)if(t!=e&&this.actions[t].endEvent===o)return;const i=this;document.addEventListener(o,(function(e){i.__nextAction(o,e.detail)}))},__runActionFunc:function(e){if(this.stageIndex>=this.selectedStage.length)return void(this.stageIndex==this.selectedStage.length&&this.__runAtag(this.selectedElement));const t=this.selectedStage[this.stageIndex],n=this.actions[t];if(n)n.runFunc?n.runFunc.call(null,this.selectedElement,e):this.__nextAction(n.endEvent,{});else{"next"===this.__runSpecialAction(t,e)&&this.__moveNextAction()}},__nextAction:function(e,t){const n=this.selectedStage[this.stageIndex];n&&e===this.actions[n].endEvent&&this.__moveNextAction(t)},__runAtag:function(e){e.querySelector("a")},__runSpecialAction:function(e,t){let n=/(\w+)\{([a-zA-Z0-9_ \-#$.]+)\}/gm.exec(e);if(!n||n.length<3)return"next";let o=n[1],i=n[2].trim();if(!i)return"next";const c=this;switch(o){case"event":document.addEventListener(i,(e=>{c.__moveNextAction(e)}),{once:!0});break;case"timeout":parseInt(i)>0&&setTimeout((function(){c.__moveNextAction(t)}),parseInt(i));break;case"action":let e=document.querySelector(i);e&&e.click();break;default:return"next"}},__moveNextAction:function(e){this.stageIndex++,this.__runActionFunc(e)}};f.__init();const h=f,p={disableAutoFill:function(e){"TEXTAREA"==e.tagName&&(e.value="",e.setAttribute("autocomplete","off")),e.hasAttribute("autocomplete")||e.setAttribute("autocomplete","off")},setAttribute:function(e){const{collection:t,document_id:n,name:o}=m().getAttr(e),i=e.getAttribute("data-realtime");e.querySelectorAll("[name], [data-pass_to]").forEach((function(e){e.parentNode.classList.contains("template")||(null==e.getAttribute("data-realtime")&&i&&e.setAttribute("data-realtime",i),e.getAttribute("name")&&!e.hasAttribute("data-collection")&&t&&e.setAttribute("data-collection",t),e.getAttribute("data-pass_to")&&!e.hasAttribute("data-pass_collection")&&t&&e.setAttribute("data-pass_collection",t),e.getAttribute("name")&&!e.getAttribute("data-document_id")&&n&&e.setAttribute("data-document_id",n),e.hasAttribute("data-document_id")||null==n||e.setAttribute("data-document_id",n))}))},checkFormValidate:function(e){return void 0===CoCreate.unique||CoCreate.unique.checkValidate(e)},isTemplateInput:function(e){if(e.classList.contains("template"))return!0;let t=e.parentNode;for(;t;){if(t.classList&&t.classList.contains("template"))return!0;t=t.parentNode}return!1},getFormData:function(e,t,n){let o={};if(!n)return{};return e.querySelectorAll(`[name][data-collection='${n}']`).forEach((e=>{let n=e.getAttribute("data-document_id")||"",i=e.getAttribute("name"),c=e.value||e.getAttribute("value");"_id"!==i&&i&&c&&t==n&&(o[i]=e.value)})),o},getParents:function(e,t="form"){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1});e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null},setDocumentIDOfElement:function(e,t){let n=e.getAttribute("data-document_id");n&&""!=n&&"pending"!=n||e.setAttribute("data-document_id",t)},getCOllections:function(e){let t=[];return e?(e.querySelectorAll("[name][data-collection]").forEach((e=>{let n=e.getAttribute("data-collection");n&&!t.includes(n)&&t.push(n)})),t):t}},g={requestAttr:"data-document_request",selectors:[],modules:[],init:function({name:e,selector:t,callback:n}){this.modules.push({name:e,selector:t,callback:n}),t&&this.selectors.push(t)},get:function(){return{selectors:this.selectors}},checkID:function(e,t="data-document_id"){let n=e.getAttribute(t)||"";return!(""===n||"pending"===n||!u.checkValue(n))},request:function({form:e,element:t,nameAttr:n,value:o}){!e&&t&&(e=t.closest("form")),e?this.__requestDocumentIdOfForm(e):t&&(n=n||"name",this.__requestDocumentId(t,n,o))},initElement:function(e){const t=e||document;if(!t.querySelectorAll)return;let n=t.querySelectorAll("form");0===n.length&&t!=document&&"FORM"===t.tagName&&(n=[t]),n.forEach((e=>{p.setAttribute(e),p.disableAutoFill(e)}))},__init:function(){const e=document.querySelectorAll("form");this.__initEvent(),e.forEach((e=>{p.setAttribute(e)}))},__initEvent:function(){const e=this;m().listen("createDocument",(function(t){const{metadata:n}=t;e.__receivedDocumentId(t)})),m().listen("deleteDocument",(function(e){const{metadata:t}=e})),document.addEventListener("clicked-submitBtn",(function(t){const{element:n}=t.detail;e.modules.forEach((({selector:e,callback:t})=>{t&&n.matches(e)&&t.call(null,n)}))}))},__deleteDocumentAction:function(e){const{collection:t,document_id:n}=m().getAttr(e);u.checkValue(t)&&u.checkValue(n)&&(m().deleteDocument({collection:t,document_id:n,metadata:"deleteDocument-action"}),document.dispatchEvent(new CustomEvent("deletedDocument",{detail:{}})))},__deleteDocumentsAction:function(e){const{collection:t,document_id:n}=m().getAttr(e),o=e.getAttribute("data-document_target");if(!o)return;const i=document.querySelectorAll(o);p.checkValue(t)&&(i.forEach((e=>{const n=e.getAttribute("data-document_id");m().checkValue(n)&&m().deleteDocument({collection:t,document_id:n,metadata:""})})),document.dispatchEvent(new CustomEvent("deletedDocuments",{detail:{}})))},__createDocumentAction:function(e){const t=e.closest("form");p.getCOllections(t).forEach((e=>{let n=p.getFormData(t,"",e);0==Object.keys(n).length&&n.constructor===Object||u.checkValue(e)&&(m().createDocument({collection:e,data:n,metadata:"createDocument-action",element:"empty"}),document.dispatchEvent(new CustomEvent("createdDocument",{detail:{}})))}))},__saveDocumentAction:function(e){const t=e.closest("form");if(!p.checkFormValidate(t))return void alert("Values are not unique");const n=this.selectors||[],o=t.querySelectorAll(n.join(","));let i=!1;for(var c=0;c<o.length;c++){let e=o[c];const{document_id:t,name:n}=m().getAttr(e);if(m().isSaveAttr(e))if(m().checkValue(t)){if(!m().isCRDT(e)){if(p.isTemplateInput(e))return;var r=new CustomEvent("clicked-submitBtn",{bubbles:!0,detail:{type:"submitBtn",element:e}});e.dispatchEvent(r)}}else n&&(i=!0)}i&&this.requestDocumentIdOfForm(t),document.dispatchEvent(new CustomEvent("savedDocument",{detail:{}}))},__requestDocumentId:function(e,t="name",n=null){const{collection:o,name:i}=m().getAttr(e);if(!o||!i)return;const c=u.generateUUID();e.setAttribute(this.requestAttr,c),m().createDocument({collection:o,element:c,metadata:""})},__requestDocumentIdOfForm:function(e){let t=this,n=e.querySelectorAll("[name], [data-pass_to]"),o=[];for(var i=0;i<n.length;i++){let c=n[i];if(c.parentNode.classList.contains("template"))continue;const r=c.getAttribute("data-collection")||c.getAttribute("data-pass_collection")||"";if(""!==r&&!o.includes(r)&&!t.checkID(c,"data-document_id")&&!t.checkID(c,"data-pass_document_id")){const t=u.generateUUID();o.push(r),c.setAttribute(this.requestAttr,t);let n=p.getFormData(e,"",r);m().createDocument({collection:r,element:t,data:n,metadata:""})}}},__setNewIdProcess:function(e,t,n){if(!e)return;e.removeAttribute(this.requestAttr);const o={document_id:t};n||this.checkID(e)||!e.hasAttribute("name")||e.setAttribute("data-document_id",t),n&&!this.checkID(e,"data-pass_document_id")&&e.hasAttribute("data-pass_to")&&(e.setAttribute("data-pass_document_id",t),e.parentNode.classList.contains("submitBtn")&&e.click());var i=new CustomEvent("set-document_id",{detail:o});e.dispatchEvent(i)},__receivedDocumentId:function(e){if(!e.document_id)return;let t=document.querySelector(`[${this.requestAttr}="${e.element}"]`);if(!t)return;let n=this;const o="FORM"===t.tagName?t:p.getParents(t,"form"),i=e.collection,c=e.document_id;if(o&&c){o.setAttribute("data-form_id",e.element);o.querySelectorAll(`[data-collection=${i}], [data-pass_collection=${i}]`).forEach((function(e){e.removeAttribute(n.requestAttr),e.hasAttribute("name")&&n.__setNewIdProcess(e,c),e.hasAttribute("data-pass_to")&&n.__setNewIdProcess(e,c,!0)}))}else t&&this.__setNewIdProcess(t,c)}};g.__init(),o.default.init({name:"CoCreateForm",observe:["subtree","childList"],include:"form",callback:function(e){g.initElement(e.target)}}),h.init({action:"createDocument",endEvent:"createdDocument",callback:(e,t)=>{g.__createDocumentAction(e)}}),h.init({action:"deleteDocument",endEvent:"deletedDocument",callback:(e,t)=>{g.__deleteDocumentAction(e)}}),h.init({action:"deleteDocuments",endEvent:"deletedDocuments",callback:(e,t)=>{CoCreateDocument.__deleteDocumentsAction(e)}}),h.init({action:"saveDocument",endEvent:"savedDocument",callback:(e,t)=>{g.__saveDocumentAction(e)}});const _=g},366:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i}),window.profiler={},window.counter=0,window.counter2=0,window.targets={},window.attributeName={},Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1});const o={initTasks:new Map,attrTasks:new Map,rules:new Map,rulesArray:[],__init:function(){const e=this;new MutationObserver(((t,n)=>e.__callback(t,n))).observe(document.body,{attributes:!0,childList:!0,subtree:!0,characterData:!1,attributeOldValue:!0,characterData:!0})},init:function({observe:e,include:t,exclude:n,attributes:o,name:i,callback:c}){e.some((e=>"childList"==e))&&this.initTasks.set(c,{observe:e,include:t,exclude:n,attributes:o,name:i}),e.some((e=>"attributes"==e))&&this.attrTasks.set(c,{observe:e,include:t,exclude:n,attributes:o,name:i})},remove:function(e){this.initTasks.delete(e),this.attrTasks.delete(e)},addRule:function({include:e,exclude:t,name:n}){this.rules.set(n,{include:e,exclude:t}),this.rulesArray=Array.from(this.rules)},removeRule:function({name:e}){this.rules.delete(e),this.rulesArray=Array.from(this.rules)},__callback:function(e,t){window.counter++;for(let t of e)"childList"==t.type&&t.addedNodes.length>0&&this.__initCallback(t),"attributes"==t.type&&this.__attrCallback(t)},__initCallback:function(e){Array.from(e.addedNodes);this.initTasks.forEach((({observe:t,include:n,exclude:o,attributes:i,name:c},r)=>{e.addedNodes.forEach((t=>{t.tagName&&(!n||t.matches(n)||t.querySelector(n))&&(o&&(t.matches(o)||t.querySelector(o))||r.apply(null,[{type:e.type,target:t}]))}))}))},__attrCallback:function(e){for(let[t,{include:n,exclude:o}]of this.rulesArray){if(n&&!e.target.matches(n))return;if(o&&e.target.matches(o))return}this.attrTasks.forEach((({observe:t,include:n,exclude:o,attributes:i,name:c},r)=>{if((!i||!e.attributeName||i.includes(e.attributeName))&&(!n||e.target.matches(n))&&(!o||!e.target.matches(o))&&e.attributeName){e.target.getAttribute(e.attributeName)!=e.oldValue&&r.apply(null,[e])}}))},setInitialized:function(e,t){e["co_initialized_"+(t=t||"")]=!0},getInitialized:function(e,t){return!!e["co_initialized_"+(t=t||"")]}};o.__init();const i=o},446:function(e,t){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(e){function t(){let t={};return e&&e.config&&(t=e.config),{apiKey:t.apiKey,securityKey:t.securityKey,organization_id:t.organization_Id}}function n(t){let n={};return e&&e.config&&(n=e.config),{apiKey:t.apiKey||n.apiKey,securityKey:t.securityKey||n.securityKey,organization_id:t.organization_id||n.organization_Id}}function o(t,n){let o={};e&&e.config&&(o=e.config);let i=t||o.organization_Id,c=n||"";return c?`${i}/${c}`:i}function i(e=36){let t=(new Date).getTime(),n=0,o="uxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(e<=o.length)o=o.substr(0,e);else{let t=e-o.length,n="-xxxyyxxx",i=Math.floor(t/n.length);for(let e=0;e<i;e++)o+=n;i=t-i*n.length,o+=n.substr(0,i)}return o.replace(/[xy]/g,(function(e){var o=16*Math.random();return t>0?(o=(t+o)%16|0,t=Math.floor(t/16)):(o=(n+o)%16|0,n=Math.floor(n/16)),("x"==e?o:7&o|8).toString(16)}))}return{getCommonParams:t,getCommonParamsExtend:n,generateSocketClient:o,GenerateUUID:i}}(window)}.apply(t,[]))||(e.exports=n)},585:function(e,t,n){var o,i;"undefined"!=typeof self&&self,o=[n(446)],void 0===(i=function(e){return function(e,t,n,o){class i{constructor(e="crud"){this.prefix=e||"crud",this.sockets=new Map,this.listeners=new Map,this.messageQueue=new Map,this.saveFileName="",this.globalScope=""}setGlobalScope(e){this.globalScope=`${this.prefix}/${e}`}getGlobalScope(){return this.globalScope}create(e){const{namespace:i,room:c}=e,r=this.getKey(i,c);let a,s=this;if(i&&this.setGlobalScope(i),this.sockets.get(r))return void(a=this.sockets.get(r));let l=t.location.protocol;"about:"===t.location.protocol&&(l=t.parent.location.protocol,e.host||(e.host=t.parent.location.host));let u="http:"===l?"ws":"wss";const d=e.port?e.port:8088;let m=`${u}://${t.location.host}:${d}/${r}`;e.host&&(m=e.host.includes("://")?`${e.host}/${r}`:e.host.includes(":")?`${u}://${e.host}/${r}`:`${u}://${e.host}:${d}/${r}`);try{a=new n(m)}catch(e){return}a.onopen=function(e){(s.messageQueue.get(r)||[]).forEach((e=>a.send(JSON.stringify(e)))),s.sockets.set(r,a),s.messageQueue.set(r,[])},a.onclose=function(t){switch(t.code){case 1e3:break;default:s.destroy(a,r),s.reconnect(a,e)}},a.onerror=function(t){s.destroy(a,r),s.reconnect(a,e)},a.onmessage=function(e){try{if(t.Blob&&e.data instanceof o)return void s.saveFile(e.data);let i=JSON.parse(e.data);if(i.data.event){if(t.CustomEvent){var n=new t.CustomEvent(i.data.event,{detail:i.data});return void t.document.dispatchEvent(n)}return void process.emit(i.data.event,i.data)}i.action;const c=s.listeners.get(i.action);if(!c)return;c.forEach((e=>{e(i.data,r)}))}catch(e){}}}send(t,n,o){const i={action:t,data:{...n,uid:e.GenerateUUID()}},c=this.getKeyByRoom(o),r=this.getByRoom(o);r?r.send(JSON.stringify(i)):this.messageQueue.get(c)?this.messageQueue.get(c).push(i):this.messageQueue.set(c,[i])}sendFile(e,t){const n=this.getByRoom(t);n&&n.send(e)}listen(e,t){this.listeners.get(e)?this.listeners.get(e).push(t):this.listeners.set(e,[t])}reconnect(e,t){let n=this;setTimeout((function(){n.create(t)}),1e3)}destroy(e,t){e&&(e.onerror=e.onopen=e.onclose=null,e.close(),e=null),this.sockets.get(t)&&this.sockets.delete(t)}destroyByKey(e){let t=this.sockets.get(e);t&&this.destroy(t,e)}getKey(e,t){let n=`${this.prefix}`;return e&&""!=e&&(n+=t&&""!=t?`/${e}/${t}`:`/${e}`),n}getByRoom(e){let t=this.getKeyByRoom(e);return this.sockets.get(t)}getKeyByRoom(e){let t=this.globalScope;return e&&(t=`${this.prefix}/${e}`),t}saveFile(e){if(t.document){const o=this.saveFileName||"downloadFile";var n=t.document.createElement("a");t.document.body.appendChild(n),n.style="display: none";let i=window.URL.createObjectURL(e);n.href=i,n.download=o,n.click(),t.URL.revokeObjectURL(i),this.saveFileName=""}}listenAsync(e){return new Promise(((n,o)=>{t.document?t.document.addEventListener(e,(function(e){n(e.detail)}),{once:!0}):process.once(e,(e=>{n(e)}))}))}}return i}(e,window,WebSocket,Blob)}.apply(t,o))||(e.exports=i)},261:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(555)),i=r(n(611)),c=r(n(266));function r(e){return e&&e.__esModule?e:{default:e}}var a={init:function(){this.initElement(),this.__initEvents()},initElement:function(e){const t=e||document;if(!t.querySelectorAll)return;let n=t.querySelectorAll("cocreate-select, div.select--field");for(let e=0;e<n.length;e++)o.default.__initSelect(n[e]),this.__initElementEvent(n[e])},__initEvents:function(){const e=this;document.addEventListener("dndsuccess",(function(t){const{dropedEl:n,dragedEl:o}=t.detail;(void 0!==n.tagName&&"cocreate-select"==n.tagName.toLowerCase()||n.classList.contains("select--field"))&&(e.save(n),n.dispatchEvent(new CustomEvent("selectedValue")))})),document.addEventListener("CoCreateSelect-save",(function(t){const{detail:{element:n}}=t;n&&e.save(n)})),i.default.listen("readDocument",(function(e){"cocreate-select"==e.metadata&&o.default.setValue(e)})),i.default.listen("updateDocument",(function(e){"cocreate-select"==e.metadata&&o.default.setValue(e)})),document.addEventListener("CoCreate-selected",(function(e){const{detail:{element:t,value:n}}=e}))},__initElementEvent:function(e){const t=this;e.addEventListener("set-document_id",(function(){t.save(this)}));let n=e.getAttribute("data-collection")||"module_activity",o=e.getAttribute("data-document_id");n&&o&&i.default.readDocument({collection:n,document_id:o,metadata:"cocreate-select"})},__sendRequest:function(e){let t=e.getAttribute("data-collection")||"module_activity",n=e.getAttribute("data-document_id");t&&n&&i.default.readDocument({collection:t,document_id:n,metadata:"cocreate-select"})},save:function(e,t=!0){let n=o.default.getValue(e),r=e.getAttribute("data-collection")||"module_activity",a=e.getAttribute("data-document_id"),s=e.getAttribute("name"),l=e.getAttribute("data-realtime")||"true";s&&("true"==l||t)&&"false"!=e.getAttribute("data-save_value")&&(c.default.checkID(e)?a&&i.default.updateDocument({collection:r,document_id:a,data:{[s]:n},upsert:!0,metadata:"cocreate-select"}):(c.default.request({element:e,value:n,nameAttr:"name"}),e.setAttribute("data-document_id","pending")))}};t.default=a},555:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,i=(o=n(366))&&o.__esModule?o:{default:o};var c={init:function(){this.initElement()},initElement:function(e){const t=e||document;if(!t.querySelectorAll)return;let n=t.querySelectorAll("cocreate-select, div.select--field");for(let e=0;e<n.length;e++){let t=n[e];this.__initSelect(t)}},__initEvents:function(){const e=this;document.addEventListener("dndsuccess",(function(t){const{dropedEl:n,dragedEl:o}=t.detail;(void 0!==n.tagName&&"cocreate-select"==n.tagName.toLowerCase()||n.classList.contains("select--field"))&&(e.save(n),e.__fireSelectedEvent(n))}))},__initSelect:function(e){if(i.default.getInitialized(e,"cocreate-select"))return;i.default.setInitialized(e,"cocreate-select");let t=e.querySelector("input"),n=e.querySelector("ul.selectable--list");const o=this;t&&t.addEventListener("keydown",(function(t){let n=t.keyCode;if(13==n&&t.preventDefault(),13==n&&this.value.length>0)o.__selectValue(this.value,e),o.save(e),o.__fireSelectedEvent(e),this.value="";else if(8==n&&!this.value.length){let t=e.querySelectorAll("[selected]");t.length>0&&(t[t.length-1].remove(),o.save(e),o.__fireSelectedEvent(e))}})),document.addEventListener("click",(function(t){e.contains(t.target)||o.__closeDropDown(e)})),n.addEventListener("click",(function(t){if(!t.target.matches("li")){let n=t.target;for(;void 0!==n.tagName&&"li"!=n.tagName.toLowerCase();)n=n.parentNode;if(n.classList&&n.classList.contains("selectable")){let t=n.getAttribute("value"),i=o.getValue(e);if(t==i||i.indexOf(t)>-1)return;o.__selectItem(n,e),o.save(e),o.__fireSelectedEvent(e)}}})),e.addEventListener("click",(function(t){if(t.target.matches(".remove"))return t.target.parentNode.remove(),o.save(e),void o.__fireSelectedEvent(e);n.classList.contains("open")||o.__openDropDown(e);let i=e.querySelector("input");i&&i.focus()}),!0)},__openDropDown:function(e,t=!0){if(t){let t=e.querySelector("input"),n=e.querySelector("ul.selectable--list");t&&(t.classList.add("open"),t.focus()),n&&n&&n.classList.add("open"),e.classList.add("active"),e.dispatchEvent(new CustomEvent("CoCreateSelect-open"))}},__closeDropDown:function(e){let t=e.querySelector("input"),n=e.querySelector("ul.selectable--list");t&&t.classList.contains("open")&&t.classList.remove("open");let o=t.value;e.hasAttribute("active")||o&&0!=o.length||e.classList.remove("active"),n&&n.classList.contains("open")&&(n.classList.remove("open"),e.dispatchEvent(new CustomEvent("CoCreateSelect-close")))},setValue:function(e){const t=this;document.querySelectorAll("cocreate-select,.select--field").forEach((n=>{const o=n.getAttribute("data-collection")||"module_activity",i=n.getAttribute("data-document_id"),c=n.getAttribute("name");e.collection==o&&e.document_id==i&&c&&t.__renderValue(n,e.data[c])}))},renderValue:function(e,t){this.__renderValue(e,t)},__renderValue:function(e,t){if(!t)return;e.querySelectorAll("[selected]").forEach((e=>e.remove()));let n=e.querySelector("ul.selectable--list");t&&"string"==typeof t&&(t=[t]);for(let o=0;o<t.length;o++){const i=n.querySelector("li[value='"+t[o]+"']");i?this.__selectItem(i,e,!1):this.__selectValue(t[o],e,!1)}try{CoCreateFloatLabel&&CoCreateFloatLabel.update(e,t&&t.length>0)}catch(e){}},__selectValue:function(e,t){let n=this.getValue(t);if(n==e||n.indexOf(e)>-1)return;let o=t.querySelector("input"),i=t.querySelector("ul.selectable--list"),c=document.createElement("span");c.innerHTML="x",c.classList.add("remove");let r=document.createElement("li");r.setAttribute("value",e),r.innerHTML=e,r.setAttribute("selected",""),r.classList.remove("selectable"),r.appendChild(c),t.insertBefore(r,o||i)},__selectItem:function(e,t,n=!0){let o=t.hasAttribute("multiple")?"multiple":"single",i=t.querySelector("input"),c=t.querySelector("ul.selectable--list");if("single"==o){t.querySelectorAll("[selected]").forEach((e=>e.remove())),i&&(i.value="")}let r=document.createElement("span");r.innerHTML="x",r.classList.add("remove");let a=e.cloneNode(!0);a.setAttribute("selected",""),a.classList.remove("selectable"),a.appendChild(r),t.insertBefore(a,i||c),"single"==o&&this.__closeDropDown(t)},getValue:function(e){let t=e.hasAttribute("multiple")?"multiple":"single",n=e.querySelectorAll("[selected]"),o=[];return n.length>0&&n.forEach((e=>o.push(e.getAttribute("value")))),o="multiple"===t?o:o[0]||"",o},save:function(e){if(!e)return;let t=new CustomEvent("CoCreateSelect-save",{detail:{element:e}});document.dispatchEvent(t)},__fireSelectedEvent:function(e){e.dispatchEvent(new CustomEvent("selectedValue")),e.dispatchEvent(new CustomEvent("input",{bubbles:!0}));let t=this.getValue(e);document.dispatchEvent(new CustomEvent("CoCreate-selected",{detail:{element:e,value:t}}))}};t.default=c},970:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var o=n(483),i=n.n(o);const c=n.p+"eaddb3aea56752094a14d18001b9856d.css";var r={injectType:"linkTag",insert:"head"};i()(c,r);const a={}},483:(e,t,n)=>{"use strict";var o,i=(o={},function(e){if(void 0===o[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}o[e]=t}return o[e]});e.exports=function(e,t){if((t=t||{}).attributes="object"==typeof t.attributes?t.attributes:{},void 0===t.attributes.nonce){var o=n.nc;o&&(t.attributes.nonce=o)}var c=document.createElement("link");if(c.rel="stylesheet",c.href=e,Object.keys(t.attributes).forEach((function(e){c.setAttribute(e,t.attributes[e])})),"function"==typeof t.insert)t.insert(c);else{var r=i(t.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(c)}return function(e){"string"==typeof e?c.href=e:c.parentNode.removeChild(c)}}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var c=t[o]={exports:{}};return e[o].call(c.exports,c,c.exports,n),c.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");o.length&&(e=o[o.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})();var o={};return(()=>{"use strict";var e=o;e.default=void 0;var t=a(n(555)),i=a(n(261)),c=a(n(366)),r=a(n(266));function a(e){return e&&e.__esModule?e:{default:e}}n(970),i.default.init(),t.default.adapter=i.default,c.default.init({name:"CoCreateSelectAttributes",observe:["attributes"],attributes:["data-document_id"],include:"cocreate-select",callback:function(e){i.default.__sendRequest(e.target)}}),c.default.init({name:"CoCreateSelect",observe:["subtree","childList"],include:"cocreate-select",callback:function(e){i.default.initElement(e.target)}}),r.default.init({name:"CoCreateSelect",selector:"cocreate-select",callback:function(e){i.default.save(e)}});var s=t.default;e.default=s})(),o=o.default})()}));